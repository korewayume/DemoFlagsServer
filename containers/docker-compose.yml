version: '2'
services:
  nginx:
    image: nginx:1.11.13
    container_name: Nginx
    ports:
      - "8001:8001"
    volumes:
      - "/etc/localtime:/etc/localtime:ro"
      - "./flags:/usr/share/nginx/html/flags"
      - "./nginx_logs:/var/log/nginx/"
      - "./nginx.nginx:/etc/nginx/conf.d/default.conf"
    command:
      - "nginx"
      - "-g"
      - "daemon off;"
  vaurien:
    image: registry.cn-beijing.aliyuncs.com/korewayume/flags-server-vaurien
    container_name: Vaurien
    links:
      - "nginx:nginx"
    ports:
      - "8002:8002"
      - "8003:8003"
    volumes:
      - "./nginx_logs:/usr/src/app/logs"
    command:
      - "ping nginx -c 5 > host"
      - "&&"
      - "cat /etc/hosts > hosts"
